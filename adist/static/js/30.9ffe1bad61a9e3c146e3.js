webpackJsonp([30],{kfoY:function(e,r){},o33Y:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t("Xxa5"),o=t.n(a),s=t("exGp"),l=t.n(s),n=t("Dd8w"),i=t.n(n),u=t("gyMJ"),c=t("sYY+"),m=t.n(c),d=t("0xDb"),p=t("NYxO"),f={data:function(){return{ruleForm:{ad:"",carouselUrl:[],coverUrl:"",desc:"",gradeId:"",name:"",notes:"",outline:"",plan:"",price:"",status:"",subjectId:"",teacherIds:"",termId:"",classQty:"",modeId:""},price:0,filter:{offset:0,limit:1e5,name:"",subjectId:"",gradeId:"",status:""},teacherIds:[],editor1:"",editor:"",teachers:[],rules:{name:[{required:!0,message:"请输入课程名称",trigger:"change"}],ad:[{required:!0,message:"请输入广告语",trigger:"change"}],subjectId:[{required:!0,message:"请选择学科",trigger:"change"}],gradeId:[{required:!0,message:"请选择年级",trigger:"change"}],termId:[{required:!0,message:"请选择所属学期",trigger:"change"}],notes:[{required:!0,message:"请输入备注信息",trigger:"change"}],coverUrl:[{required:!0,message:"请上传缩略图",trigger:"change"}],carouselUrl:[{required:!0,message:"请上传顶部轮播",trigger:"change"}],desc:[{required:!0,message:"请输入课程详情",trigger:"change"}],outline:[{required:!0,message:"请输入课程大纲",trigger:"change"}],status:[{required:!0,message:"请选择上下架",trigger:"change"}],classQty:[{required:!0,message:"请输入课次",trigger:"change"}],modeId:[{required:!0,message:"请选择授课模式",trigger:"change"}],price:[{required:!0,message:"价格不能为空"},{type:"number",message:"价格为数字值"}]}}},computed:i()({},Object(p.b)({QiuniuToken:function(e){return e.Account.QnInfo.token},QiuniuDomain:function(e){return e.Account.QnInfo.domainName}})),watch:{price:function(e){this.ruleForm.price=100*e}},mounted:function(){var e=this;return l()(o.a.mark(function r(){var t,a;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.$route.query.id){r.next=9;break}return r.next=3,u.c.querySchoolDetail(e.$route.query.id);case 3:t=r.sent,e.ruleForm=t.data,e.teacherIds=e.ruleForm.teachers?e.ruleForm.teachers.map(function(e){return e.id}):[],e.ruleForm.desc=e.ruleForm.desc?e.ruleForm.desc:"",e.ruleForm.outline=e.ruleForm.outline?e.ruleForm.outline:"",e.price=e.ruleForm.price/100;case 9:return r.next=11,u.a.queryQnToken();case 11:a=r.sent,e.$store.commit("Account/QUERY_QTOKEN",a.data),e.remoteMethod(),e.editor=new m.a(e.$refs.editor),e.editor.customConfig.uploadImgShowBase64=!1,e.editor.customConfig.showLinkImg=!1,e.editor.customConfig.qiniu=!0,e.editor.create(),e.$route.query.id&&e.editor.txt.html(e.ruleForm.desc),Object(d.a)({token:e.QiuniuToken,domain:e.QiuniuDomain})(e.editor),e.editor1=new m.a(e.$refs.editor1),e.editor1.customConfig.uploadImgShowBase64=!1,e.editor1.customConfig.showLinkImg=!1,e.editor1.customConfig.qiniu=!0,e.editor1.create(),e.$route.query.id&&e.editor1.txt.html(e.ruleForm.outline),Object(d.a)({token:e.QiuniuToken,domain:e.QiuniuDomain})(e.editor1);case 28:case"end":return r.stop()}},r,e)}))()},methods:{createdSchool:function(){var e=this;return l()(o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e.ruleForm.desc=e.editor.txt.html(),e.ruleForm.outline=e.editor1.txt.html(),r.next=5,e.$refs.ruleForm.validate();case 5:return e.ruleForm.teacherIds=e.teacherIds.join(":"),r.next=9,u.c.createdSchool(e.ruleForm);case 9:e.$message.success("成功"),e.$router.push("course"),r.next=17;break;case 13:r.prev=13,r.t0=r.catch(0),e.ruleForm.teacherIds=[];case 17:case"end":return r.stop()}},r,e,[[0,13]])}))()},remoteMethod:function(e){var r=this;return l()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.i.querySchool(r.filter);case 2:t=e.sent,r.teachers=t.data;case 4:case"end":return e.stop()}},e,r)}))()},successFile:function(e){this.ruleForm.coverUrl=this.$store.state.Account.QnInfo.domainName+e.key},successSwiper:function(e){this.ruleForm.carouselUrl.push(this.$store.state.Account.QnInfo.domainName+e.key)},handleRemove:function(e){var r=this;return l()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.$confirm("确定删除该轮播图");case 2:r.ruleForm.carouselUrl.splice(e,1);case 3:case"end":return t.stop()}},t,r)}))()}}},g={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"box courseDetail"},[t("header-tit",{attrs:{img:"courT.png",tit:"选课中心",back:"1"}}),e._v(" "),t("div",{staticClass:"content"},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{label:"课程名称",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"广告语",prop:"ad"}},[t("el-input",{model:{value:e.ruleForm.ad,callback:function(r){e.$set(e.ruleForm,"ad",r)},expression:"ruleForm.ad"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"课次",prop:"classQty"}},[t("el-input",{model:{value:e.ruleForm.classQty,callback:function(r){e.$set(e.ruleForm,"classQty",e._n(r))},expression:"ruleForm.classQty"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"课程学科",prop:"subjectId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.subjectId,callback:function(r){e.$set(e.ruleForm,"subjectId",r)},expression:"ruleForm.subjectId"}},e._l(e.$store.state.BaseConfig.subjects,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{staticClass:"grade-margin",attrs:{label:"课程年级",prop:"gradeId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.gradeId,callback:function(r){e.$set(e.ruleForm,"gradeId",r)},expression:"ruleForm.gradeId"}},e._l(e.$store.state.BaseConfig.grades,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{staticClass:"grade-margin",attrs:{label:"授课模式",prop:"modeId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.modeId,callback:function(r){e.$set(e.ruleForm,"modeId",r)},expression:"ruleForm.modeId"}},e._l(e.$store.state.BaseConfig.courses,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"授课教师",prop:"teacherIds"}},[t("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.teacherIds,callback:function(r){e.teacherIds=r},expression:"teacherIds"}},e._l(e.teachers,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"所属学期",prop:"termId"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.termId,callback:function(r){e.$set(e.ruleForm,"termId",r)},expression:"ruleForm.termId"}},e._l(e.$store.state.BaseConfig.terms,function(e,r){return t("el-option",{key:r,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"商品价格",prop:"price"}},[t("el-input",{attrs:{placeholder:"请输入价格",autoComplete:"off"},model:{value:e.price,callback:function(r){e.price=e._n(r)},expression:"price"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"备注信息",prop:"notes"}},[t("el-input",{model:{value:e.ruleForm.notes,callback:function(r){e.$set(e.ruleForm,"notes",r)},expression:"ruleForm.notes"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"缩略图",prop:"coverUrl"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{data:{token:e.$store.state.Account.QnInfo.token},action:"http://up-z0.qiniu.com","show-file-list":!1,"on-success":e.successFile}},[e.ruleForm.coverUrl?t("img",{staticClass:"avatar",attrs:{src:e.ruleForm.coverUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"轮播顶图",prop:"carouselUrl"}},[t("div",{staticClass:"swo"},[t("el-upload",{staticClass:"avatar-uploader",attrs:{data:{token:e.$store.state.Account.QnInfo.token},action:"http://up-z0.qiniu.com","show-file-list":!1,"on-success":e.successSwiper}},[t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),e._l(e.ruleForm.carouselUrl,function(r,a){return t("img",{key:a,staticClass:"img",attrs:{src:r,alt:""},on:{click:function(r){e.handleRemove(a)}}})})],2)]),e._v(" "),t("el-form-item",{attrs:{prop:"desc",label:"课程详情"}},[t("div",{staticClass:"info"},[t("div",[t("div",{ref:"editor",staticStyle:{"text-align":"left"}})])])]),e._v(" "),t("el-form-item",{attrs:{prop:"outline",label:"课程大纲"}},[t("div",{staticClass:"info"},[t("div",{ref:"editor1",staticStyle:{"text-align":"left"}})])]),e._v(" "),t("el-form-item",{attrs:{label:"上下架",prop:"status"}},[t("el-radio",{attrs:{label:"ON_SALE"},model:{value:e.ruleForm.status,callback:function(r){e.$set(e.ruleForm,"status",r)},expression:"ruleForm.status"}},[e._v("上架")]),e._v(" "),t("el-radio",{attrs:{label:"disable"},model:{value:e.ruleForm.status,callback:function(r){e.$set(e.ruleForm,"status",r)},expression:"ruleForm.status"}},[e._v("下架")])],1)],1),e._v(" "),t("div",{staticClass:"bo mar"},[t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.createdSchool()}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var v=t("VU/8")(f,g,!1,function(e){t("kfoY")},"data-v-0217077d",null);r.default=v.exports}});